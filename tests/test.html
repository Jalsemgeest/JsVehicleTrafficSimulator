<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<!--
/**********************************************************************
 * This file is part of a Vehicle Traffic Simulator written 
 * entirely in Javascript, HTML and CSS.  The application allows for 
 * the creation of roadways upon which vehicles will travel and
 * attempt to avoid collisions with other vehicles while obeying the
 * rules of the road including traffic lights and speed limits
 * 
 * @Created: 04/09/2013
 * @Author: Jason Holt Smith (bicarbon8@gmail.com)
 * @Version: 0.2.0
 * Copyright (c) 2013 Jason Holt Smith. JsVehicleTrafficSimulator is 
 * distributed under the terms of the GNU General Public License.
 * 
 * This file is part of JsVehicleTrafficSimulator.
 * 
 * JsVehicleTrafficSimulator is free software: you can redistribute it 
 * and/or modify it under the terms of the GNU General Public License 
 * as published by the Free Software Foundation, either version 3 of 
 * the License, or (at your option) any later version.
 * 
 * JsVehicleTrafficSimulator is distributed in the hope that it will 
 * be useful, but WITHOUT ANY WARRANTY; without even the implied 
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  
 * See the GNU General Public License for more details.
 * 
 * You should have received a copy of the GNU General Public License
 * along with JsVehicleTrafficSimulator.  If not, see 
 * <http://www.gnu.org/licenses/>.
 **********************************************************************/
-->
<html lang="en">
<head>
<title>Traffic Simulator</title>
<script language="javascript" src="http://code.jquery.com/jquery-2.0.3.min.js"></script>
<script language="javascript" src="ext/physicsjs-full-0.6.0.min.js"></script>
<script language="javascript">
var Sun = {
    radius: 695500,
    mass: Number("1.989E30"),
    x: 0,
    y: 0,
    vx: 0,
    vy: 0,
    styles: {
        fillStyle: '#FFFF00'
    }
}
var Mercury = {
    radius: 2440,
    mass: Number("328.5E21"),
    x: 57910000+Sun.radius, // distance from edge of sun, not centre
    y: 0,
    vx: 0,
    vy: 48,
    styles: {
        fillStyle: '#DF0101'
    }
}
$(document).ready(function () {
    Physics(function (world) {

        var viewWidth = window.innerWidth
            ,viewHeight = window.innerHeight
            // center of the window
            ,center = Physics.vector(viewWidth, viewHeight).mult(0.5)
            ,renderer
            ,layer
            ;

        // create a renderer
        renderer = Physics.renderer('canvas', {
            el: document.querySelector('#PhysicsCanvas')
            ,width: viewWidth
            ,height: viewHeight
        });
        layer = renderer.addLayer("layer1", document.querySelector('#PhysicsCanvas'), {scale: 1}); //{scale: 1/2440});

        // add the renderer
        world.add(renderer);
        // render on each step
        world.on('step', function () {
            world.render();
        });

        // resize events
        window.addEventListener('resize', function () {
            viewWidth = window.innerWidth;
            viewHeight = window.innerHeight;
            renderer.el.width = viewWidth;
            renderer.el.height = viewHeight;
        }, true);

        // // some fun colors
        // var colors = [
        //     '#b58900',
        //     '#cb4b16',
        //     '#dc322f',
        //     '#d33682',
        //     '#6c71c4',
        //     '#268bd2',
        //     '#2aa198',
        //     '#859900'
        // ];
        // // create some bodies
        // var l = 10;
        // var bodies = [];
        // var v = Physics.vector(0, 300);
        // var b, r;

        // r = 285;
        // b = Physics.body('circle', {
        //     radius: r
        //     ,mass: r
        //     ,x: center.x
        //     ,y: center.y
        //     ,vx: v.perp().mult(0.0001).x
        //     ,vx: v.y
        //     ,styles: {
        //         fillStyle: colors[ l % colors.length ]
        //     }
        // });
        // bodies.push(b);
        var v = Physics.vector(0, 300);
        var Sun = {
            radius: 143, //695500,
            mass: Number("1.989E30") / 4880,
            x: Math.ceil(viewWidth/2),
            y: Math.ceil(viewHeight/2),
            styles: {
                fillStyle: '#FFFF00'
            }
        };
        var Mercury = {
            radius: 1, //2440,
            mass: Number("328.5E21") / 4880,
            x: 2,//Math.ceil(57910000/2440)+Sun.radius+Sun.x, // distance from edge of sun, not centre
            y: 2,
            styles: {
                fillStyle: '#DF0101'
            }
        };
        // add things to the world
        var bodies = [
            Physics.body('circle', Sun), 
            // Physics.body('circle', Mercury)
        ];

        world.add( bodies );
        layer.addToStack( bodies );
        world.add([
            Physics.behavior('newtonian', { 
                strength: 0.005,
                min: 10 
            }),
            Physics.behavior('sweep-prune'),
            Physics.behavior('body-collision-detection'),
            Physics.behavior('body-impulse-response')
        ]);

        // subscribe to ticker to advance the simulation
        Physics.util.ticker.on(function( time ) {
            world.step( time );
        });

        // start the ticker
        Physics.util.ticker.start();
    });
});
</script>
</head>
<body style="margin: 0px; padding: 0px;">
    <canvas id="PhysicsCanvas" style="background-color: rgb(0, 0, 0);"></canvas>
</body>
</html>